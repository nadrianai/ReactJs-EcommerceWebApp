{"version":3,"file":"static/js/376.fadb7c42.chunk.js","mappings":"kNAkGA,UA3FyB,SAACA,GACtB,OAA0BC,EAAAA,EAAAA,UAAS,IAAnC,eAAOC,EAAP,KAAcC,EAAd,KACA,GAAgCF,EAAAA,EAAAA,UAAS,IAAzC,eAAOG,EAAP,KAAiBC,EAAjB,KAEIC,GAAWC,EAAAA,EAAAA,MACXC,GAAUC,EAAAA,EAAAA,OAEdC,EAAAA,EAAAA,YAAU,WACNP,EAASQ,OAAOC,aAAaC,QAAQ,wBACxC,GAAE,IAGH,IAAMC,EAAY,yCAAG,WAAMC,GAAN,iFACjBA,EAAEC,iBACEd,GAAUE,EAFG,uBAGba,EAAAA,GAAAA,MAAY,oCAHC,+BAMdb,EAASc,OAAS,GANJ,uBAObD,EAAAA,GAAAA,MAAY,gDAPC,oDAWQE,EAAAA,EAAAA,oBAAyBjB,EAAOS,OAAOS,SAASC,MAXxD,mBAaHC,KAAKC,cAbF,wBAcTZ,OAAOC,aAAaY,WAAW,wBAC3BF,EAAOH,EAAAA,EAAAA,YAfF,UAgBHG,EAAKG,eAAerB,GAhBjB,yBAiBmBkB,EAAKI,aAjBxB,QAiBHC,EAjBG,QAmBTC,EAAAA,EAAAA,IAAmBD,GACdE,MAAK,SAAAC,GACFxB,EAAS,CACLyB,KAAK,iBACLC,QAAQ,CACJ9B,MAAM4B,EAAIG,KAAK/B,MACfgC,KAAKJ,EAAIG,KAAKC,KACdC,MAAMR,EACNS,KAAKN,EAAIG,KAAKG,KACdC,IAAIP,EAAIG,KAAKI,MAGxB,IACAR,MAAK,WACFrB,EAAQ8B,KAAK,IAChB,IACAC,OAAM,SAAAC,GACHC,QAAQC,IAAIF,EACf,IArCI,0DAwCbC,QAAQC,IAAR,MACAzB,EAAAA,GAAAA,MAAY,KAAM0B,SAzCL,0DAAH,sDAgEpB,OACE,gBAAKC,UAAU,gBAAf,UACI,gBAAKA,UAAU,MAAf,UACI,iBAAKA,UAAU,uBAAf,WACI,+CArBL,kBAAMC,SAAU/B,EAAhB,WACK,kBAAOiB,KAAK,QACRa,UAAU,6BACVE,aAAc5C,KAEjB,kBAAO6B,KAAK,WACTa,UAAU,oBACVG,MAAQ3C,EACR4C,SAAU,SAAAjC,GAAC,OAAGV,EAAYU,EAAEkC,OAAOF,MAAxB,EACXG,WAAS,EACTC,YAAY,yBAEhB,mBAAQC,KAAK,SAASR,UAAU,iBAAhC,8CAkBf,C","sources":["pages/auth/RegisterComplete.js"],"sourcesContent":["import React, {useState, useEffect} from 'react'\r\nimport { toast } from 'react-toastify'\r\nimport { auth } from '../../firebase'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { useHistory } from 'react-router-dom';\r\nimport {createOrUpdateUser} from '../../functions/auth'\r\n\r\nconst RegisterComplete = (props) => {\r\n    const [email, setEmail] = useState('')\r\n    const [passowrd, setPassword] = useState('')\r\n\r\n    let dispatch = useDispatch()\r\n    let history = useHistory()\r\n\r\n    useEffect(()=>{\r\n        setEmail(window.localStorage.getItem('emailForRegistration'))\r\n    }, [])\r\n\r\n\r\n    const handleSubmit = async(e) =>{\r\n        e.preventDefault()\r\n        if(!email || !passowrd){\r\n            toast.error('Email and password are required!')\r\n            return\r\n        }\r\n        if(passowrd.length < 6){\r\n            toast.error('Password must be at least 6 characters long!')\r\n            return\r\n        }\r\n       try {\r\n            const result = await auth.signInWithEmailLink(email, window.location.href)\r\n            // console.log(result)\r\n            if(result.user.emailVerified){\r\n                window.localStorage.removeItem(\"emailForRegistration\")\r\n                let user = auth.currentUser\r\n                await user.updatePassword(passowrd)\r\n                const idTokenResult = await user.getIdToken()\r\n                \r\n                createOrUpdateUser(idTokenResult)\r\n                    .then(res =>{\r\n                        dispatch({\r\n                            type:\"LOGGED_IN_USER\",\r\n                            payload:{\r\n                                email:res.data.email,\r\n                                name:res.data.name,\r\n                                token:idTokenResult,\r\n                                role:res.data.role,\r\n                                _id:res.data._id\r\n                            }\r\n                        })\r\n                    })\r\n                    .then(()=>{\r\n                        history.push('/')\r\n                    })\r\n                    .catch(err =>{\r\n                        console.log(err)\r\n                    })          \r\n             }\r\n       } catch (error) {\r\n            console.log(error)\r\n            toast.error(error.message)\r\n       }\r\n    }\r\n\r\n    const completeRegistrationForm =() =>{\r\n        return(\r\n           <form onSubmit={handleSubmit}>\r\n                <input type=\"email\" \r\n                    className='form-control mb-3 disabled' \r\n                    defaultValue={email} \r\n                    />\r\n                 <input type=\"password\" \r\n                    className='form-control mb-3' \r\n                    value ={passowrd} \r\n                    onChange={e=> setPassword(e.target.value)}\r\n                    autoFocus\r\n                    placeholder='Enter password here'\r\n                    />\r\n                <button tyle=\"submit\" className='btn btn-raised'> Complete Registration </button>\r\n           </form>\r\n        )\r\n        \r\n    }\r\n  return (\r\n    <div className='container p-5'>\r\n        <div className=\"row\">\r\n            <div className=\"col-md-6 offset-md-3\">\r\n                <h4>\r\n                Register Complete\r\n                </h4>\r\n                {completeRegistrationForm()}\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default RegisterComplete"],"names":["props","useState","email","setEmail","passowrd","setPassword","dispatch","useDispatch","history","useHistory","useEffect","window","localStorage","getItem","handleSubmit","e","preventDefault","toast","length","auth","location","href","user","emailVerified","removeItem","updatePassword","getIdToken","idTokenResult","createOrUpdateUser","then","res","type","payload","data","name","token","role","_id","push","catch","err","console","log","message","className","onSubmit","defaultValue","value","onChange","target","autoFocus","placeholder","tyle"],"sourceRoot":""}